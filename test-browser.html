<!DOCTYPE html>
<html>
<head>
    <title>Gemini API Test</title>
</head>
<body>
    <h1>Testing Gemini API from Browser</h1>
    <button onclick="testChat()">Test Chat</button>
    <div id="result" style="margin-top: 20px; padding: 10px; border: 1px solid #ccc;"></div>

    <script type="module">
        import { GoogleGenerativeAI, HarmCategory, HarmBlockThreshold } from 'https://esm.run/@google/generative-ai@0.21.0';
        
        window.testChat = async function() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = 'Testing...';
            
            try {
                // Read API key from .env.local (you'll need to paste it here for browser test)
                const API_KEY = 'AIzaSyApqy2zU3S7bKW9FwwqpcdAr2SKPTvXGRQ'; // Replace with your actual key
                
                const genAI = new GoogleGenerativeAI(API_KEY);
                const model = genAI.getGenerativeModel({
                    model: 'models/gemini-flash-latest',
                    safetySettings: [
                        {
                            category: HarmCategory.HARM_CATEGORY_HARASSMENT,
                            threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,
                        },
                        {
                            category: HarmCategory.HARM_CATEGORY_HATE_SPEECH,
                            threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,
                        },
                        {
                            category: HarmCategory.HARM_CATEGORY_SEXUALLY_EXPLICIT,
                            threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,
                        },
                        {
                            category: HarmCategory.HARM_CATEGORY_DANGEROUS_CONTENT,
                            threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,
                        },
                    ],
                });

                const result = await model.generateContent('Hello! Can you hear me?');
                const response = await result.response;
                const text = response.text();
                
                resultDiv.innerHTML = '<h2>✅ SUCCESS!</h2><p>' + text + '</p>';
            } catch (error) {
                resultDiv.innerHTML = '<h2>❌ ERROR</h2><p>' + error.message + '</p><pre>' + JSON.stringify(error, null, 2) + '</pre>';
            }
        };
    </script>
</body>
</html>
